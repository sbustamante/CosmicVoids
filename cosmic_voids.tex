\documentclass[a4,useAMS,usenatbib,usegraphicx]{mn2e} 
%\documentclass{latex/emulateapj} 
%External Packages and personalized macros
%=========================================================================
%		EXTERNAL PACKAGES
%=========================================================================
\usepackage{amsmath} 
\usepackage{amssymb} 
%\usepackage[section]{placeins}
\usepackage {graphicx}
%\usepackage{graphics}
\usepackage[dvips]{epsfig}
\usepackage{epsfig}  
\usepackage{color}
\usepackage[normalem]{ulem}
\usepackage{hyperref}
\usepackage{caption}
%Non reposionated tables
\usepackage{float}
\restylefloat{table}

%=========================================================================
%		INTERNAL MACROS
%=========================================================================
\def\be{\begin{equation}}
\def\ee{\end{equation}}
\def\ba{\begin{eqnarray}}
\def\ea{\end{eqnarray}}

% To highlight comments 
\definecolor{red}{rgb}{1,0.0,0.0}
\newcommand{\red}{\color{red}}
\definecolor{darkgreen}{rgb}{0.0,0.5,0.0}
\newcommand{\SRK}[1]{\textcolor{darkgreen}{\bf SRK: \textit{#1}}}
\newcommand{\SRKED}[1]{\textcolor{darkgreen}{\bf #1}}

\newcommand{\LCDM}{$\Lambda$CDM~}
\newcommand{\beq}{\begin{eqnarray}}  
\newcommand{\eeq}{\end{eqnarray}}  
\newcommand{\zz}{$z\sim 3$} 
\newcommand{\apj}{ApJ}  
\newcommand{\apjs}{ApJS}  
\newcommand{\apjl}{ApJL}  
\newcommand{\aj}{AJ}  
\newcommand{\mnras}{MNRAS}  
\newcommand{\mnrassub}{MNRAS accepted}  
\newcommand{\aap}{A\&A}  
\newcommand{\aaps}{A\&AS}  
\newcommand{\araa}{ARA\&A}  
\newcommand{\nat}{Nature}  
\newcommand{\physrep}{PhR}
\newcommand{\pasp}{PASP}    
\newcommand{\pasj}{PASJ}    
\newcommand{\avg}[1]{\langle{#1}\rangle}  
\newcommand{\ly}{{\ifmmode{{\rm Ly}\alpha}\else{Ly$\alpha$}\fi}}
\newcommand{\hMpc}{{\ifmmode{h^{-1}{\rm Mpc}}\else{$h^{-1}$Mpc}\fi}}  
\newcommand{\hGpc}{{\ifmmode{h^{-1}{\rm Gpc}}\else{$h^{-1}$Gpc}\fi}}  
\newcommand{\hmpc}{{\ifmmode{h^{-1}{\rm Mpc}}\else{$h^{-1}$Mpc}\fi}}  
\newcommand{\hkpc}{{\ifmmode{h^{-1}{\rm kpc}}\else{$h^{-1}$kpc}\fi}}  
\newcommand{\hMsun}{{\ifmmode{h^{-1}{\rm {M_{\odot}}}}\else{$h^{-1}{\rm{M_{\odot}}}$}\fi}}  
\newcommand{\hmsun}{{\ifmmode{h^{-1}{\rm {M_{\odot}}}}\else{$h^{-1}{\rm{M_{\odot}}}$}\fi}}  
\newcommand{\Msun}{{\ifmmode{{\rm {M_{\odot}}}}\else{${\rm{M_{\odot}}}$}\fi}}  
\newcommand{\msun}{{\ifmmode{{\rm {M_{\odot}}}}\else{${\rm{M_{\odot}}}$}\fi}}  
\newcommand{\lya}{{Lyman$\alpha$~}}
\newcommand{\clara}{{\texttt{CLARA}}~}
\newcommand{\rand}{{\ifmmode{{\mathcal{R}}}\else{${\mathcal{R}}$ }\fi}}  
%SAMPLES
\newcommand{\GHBDM}{\texttt{GH}$_{\mbox{\tiny{BDM}}}$ }
\newcommand{\GHFOF}{\texttt{GH}$_{\mbox{\tiny{FOF}}}$ }
\newcommand{\IHBDM}{\texttt{IH}$_{\mbox{\tiny{BDM}}}$ }
\newcommand{\IHFOF}{\texttt{IH}$_{\mbox{\tiny{FOF}}}$ }
\newcommand{\PBDM}{\texttt{P}$_{\mbox{\tiny{BDM}}}$ }
\newcommand{\PFOF}{\texttt{P}$_{\mbox{\tiny{FOF}}}$ }
\newcommand{\IPBDM}{\texttt{IP}$_{\mbox{\tiny{BDM}}}$ }
\newcommand{\IPFOF}{\texttt{IP}$_{\mbox{\tiny{FOF}}}$ }
\newcommand{\RIPBDM}{\texttt{RIP}$_{\mbox{\tiny{BDM}}}$ }
\newcommand{\RIPFOF}{\texttt{RIP}$_{\mbox{\tiny{FOF}}}$ }


%MY COMMANDS #############################################################
\newcommand{\sub}[1]{\mbox{\scriptsize{#1}}}
\newcommand{\dtot}[2]{ \frac{ d #1 }{d #2} }
\newcommand{\dpar}[2]{ \frac{ \partial #1 }{\partial #2} }
\newcommand{\pr}[1]{ \left( #1 \right) }
\newcommand{\corc}[1]{ \left[ #1 \right] }
\newcommand{\lla}[1]{ \left\{ #1 \right\} }
\newcommand{\bds}[1]{\boldsymbol{ #1 }}
\newcommand{\oiint}{\displaystyle\bigcirc\!\!\!\!\!\!\!\!\int\!\!\!\!\!\int}
\newcommand{\mathsize}[2]{\mbox{\fontsize{#1}{#1}\selectfont $#2$}}
\newcommand{\eq}[2]{\begin{equation} \label{eq:#1} #2 \end{equation}}
\newcommand{\lth}{$\lambda_{th}$ }
\newcommand{\reff}{{\ifmmode{r_{\mbox{\tiny eff}}}\else{$r_{\mbox{\tiny eff}}$}\fi}}
%#########################################################################

\begin{document}

%=========================================================================
%		FRONT MATTER
%=========================================================================
\title{Tidal field anisotropy as a tracer of cosmic voids}
\author[S. Bustamante and J.E. Forero-Romero]{
\parbox[t]{\textwidth}{\raggedright 
  Sebastian Bustamante \thanks{sebastian.bustamante@udea.edu.co}$^{1}$,
  Jaime E. Forero-Romero \thanks{je.forero@uniandes.edu.co}$^{2}$ 
}
\vspace*{6pt}\\
$^1$Instituto de F\'{\i}sica - FCEN, Universidad de Antioquia, Calle
67 No. 53-108, Medell\'{\i}n, Colombia\\ 
$^2$Departamento de F\'{i}sica, Universidad de los Andes, Cra. 1
No. 18A-10, Edificio Ip, Bogot\'a, Colombia
}

\maketitle

\begin{abstract}
Finding and characterizing underdense regions (voids) in the large
scale structure of the Universe is an important task in cosmological
studies.  
In this paper we present a new algorithm to find voids in
cosmological simulations.  
Our approach is based on algorithms that use the tidal and the
velocity shear tensors to locally define the cosmic web.
Voids are identified using the fractional anisotropy (FA) computed
from the eigenvalues of each web scheme. 
We define the void boundaries using a watershed transform based on the
local minima of the FA and its boundaries as the regions where the FA
is maximized.
This void identification technique does not have any free parameters
and does not make any assumption on the shape or structure of the
voids.  
We test the method on the Bolshoi simulation and report on the density
and velocity profiles for the voids found using this new scheme. 
We find that...
\end{abstract}

\begin{keywords}
Cosmology: theory - large-scale structure of Universe -
Methods: data analysis - numerical - N-body simulations
\end{keywords}


%=========================================================================
%		PAPER CONTENT
%=========================================================================

%*************************************************************************
\section{Introduction}
\label{sec:introduction}
%*************************************************************************

Voids have been identified as one of the most striking features of the
Universe on its larges scales since they were found in the first
galaxy surveys \citep{Chincarini75, Gregory78, Einasto80M, Einasto80N,
  Kirshner81, Zeldovich82,Kirshner87}.  
However, due to the large volume extension of void regions ($\sim
5-10\ \mbox{Mpc}  h^{-1}$), statistically meaningful catalogues of
voids \citep{Pan10,  Sutter12b, Nadathur14} have only become available
through modern galaxy surveys such as the two-degree field Galaxy
Redshift Survey (2dF) \citep{ Colless01, Colless03} and the Sloan
Digital Sky Survey (SDSS)\citep{York00, Abazajian03}.
These observational breakthughs generated a great interest in the last
decade to study voids \citep{Hoyle04, Croton04, Rojas05,
  Ceccarelli06, Patiri06a, Tikhonov06, Patiri06b,Tikhonov07,
  BendaBeckmann08, Foster09, Ceccarelli13, Sutter14a}. 


On the theoretical side the basic framework that explains
the origin of voids was established in the seminal work of
\citet{Zeldovich70} and refined in the following decades.  
The first detailed theoretical models describing formation, dynamics
and properties of  voids \citep{Hoffman82, Icke84, Bertschinger85,
  Blumenthal92} were  complemented and extended by numerical studies
\citep{Martel90, Regos91, Weygaert93, Dubinski93, Bond96}. 
Currently, the most popular approach to study voids relies on N-body
simulations. For an extensive compilation of previous  
numerical works we refer the reader to \citet{Colberg08}.


The relevance of voids to cosmological studies can be summarized in
three aspects \citep{Platen07}. 
Firstly, voids are a key ingredient of the Cosmic Web. 
They dominate the volume distribution at large scales and
additionally, compensating overdense structures in the total matter
budget. 
Secondly, voids provide a valuable resource to estimate  
cosmological parameters as their structure and dynamics are sensitive
to them. 
Finally, they are a largely pristine environment to test galaxy
evolution. 


Although visual recognition of voids in galaxy surveys and simulations
is possible in most cases, we need a clear algorithmic identification
procedure to make statistical studies.
Nevertheless, the community has not reached yet an unambiguous
definition of cosmic voids, with many different void finding
techniques in the literature  (for a detailed comparison of different
schemes,  see the publication on the results of the Void Finder
Comparison Project \citet{Colberg08}).  
In spite of the diversity of existing schemes, they can be roughly
classified into two types. First, geometric schemes based on
point distributions (either real or redshift space) of galaxies in
surveys or dark matter halos in  simulations \citep{Kauffmann91, Muller00, 
  Gottlober03, Hoyle04, Brunino07,  Foster09, Micheletti14, Sutter14}.
Second, schemes based on the smooth and continuous matter density
field either from simulations or from reconstruction procedures on
surveys \citep{Plionis02, Colberg05,  Shandarin06, Platen07,
  Neyrinck08, MunozCuartas11, Neyrinck13, Ricciardelli2013}. 
Our work is based on the second kind of schemes. 


Here we introduce a new algorithm to define voids over the continous
matter density or velocity distribution defined on a fixed and
homogeneous spatial grid.
The algorithm is based on two tensorial schemes used to classify the
cosmic web. 
The first (the T-web) is based on the Hessian of the gravitational potential or
tidal tensor \citep{Hahn07, Forero09}. 
The second (the V-web) is based on the velocity shear tensor
\citep{Hoffman12}. 
Our procedure allows a description of the internal structure
of voids that goes beyond a simple definition of a void as just an
underdense regions in the large-scale matter distribution.
The tidal and the shear tensors encode more information than the
density field as they trace the collapsing or expanding
nature of the matter field, which defines the dynamics of the Cosmic
Web. 

The tracer that we use to define the voids is the fractional
anisotropy (FA) computed from the set of eigenvalues of the tensor
under consideration. 
The FA was initially introduced by \citet{Basser95} to quantify the
anisotropy degree of the diffusivity of water molecules through
cerebral tissue in nuclear magnetic resonance
imaging and \citet{Libeskind13} introduced this concept in the context
of Cosmic Web classification schemes. 

Once we establish the FA as a void tracer, we proceed to
identify individual voids as basins of FA local minima. 
At this point we implement a \textit{watershed transform algorithm}
\citep{Beucher79,Beucher93} which has been used to define voids as
catching basins of local minima of the density field
\citep{Platen07,Neyrinck08}.

This paper is organized as follows. 
In Section \ref{sec:algorithms_cosmic_web} we describe the algorithms
we use to find the cosmic web in N-body simulations. 
In Section \ref{sec:bulk_voids} we explain in detail our void finder
based on the fractional anisotropy of the tidal and shear tensor
fields. 
In Section  \ref{sec:simulations} we describe the N-body simulation we
use to test our algorithm. 
Our results are presented in \ref{sec:results} to finally comment and
conclude about these findings in Section \ref{sec:conclusions}. 


%*************************************************************************
\section{Algorithms to find the Cosmic Web}
\label{sec:algorithms_cosmic_web}
%*************************************************************************


%.........................................................................
%FIGURE 1: FA and vissual impression
\begin{figure*}
  \includegraphics[trim = 16mm 8mm 5mm 12mm, clip, keepaspectratio=true,
  width=0.73\textheight]{cosmicweb_FA_Tweb.pdf}
  \includegraphics[trim = 16mm 8mm 5mm 12mm, clip, keepaspectratio=true,
  width=0.73\textheight]{cosmicweb_FA_Vweb.pdf}
  \caption{Left colum. Visual impression of the 
  Fractional Anisotropy field over a slide of the simulation for each
  web scheme (T-Web top. V-Web bottom).  
  Middle column. Cosmic Web identification. Voids
  are white, sheets are light gray, filaments are dark gray and
  knots are black.
  Right column. Colors are voids identified by our Fractional
  Anisotropy method.}
  \label{fig:FA_field}
\end{figure*}
%.........................................................................

In next two subsections we describe the major features of the two
algorithms (T-web and V-web) we use to find and classify the cosmic web in cosmological
N-body simulations. 
These schemes have also been used to develop other kind of studies
such as the alignment of the shape, spin and peculiar velocity of dark
matter halos with the cosmic web \citep{Libeskind13,Forero2014}.
We refer the reader to the paper of \cite{Forero09} and
\cite{Hoffman12} to read a detailed description of each algorithm. 


%-------------------------------------------------------------------------
\subsection{The tidal web (T-Web)}
\label{subsec:Tweb}
%-------------------------------------------------------------------------


This scheme was initially proposed by \citet{Hahn07} as an
alternative for classifying the Cosmic Web based on the tidal tensor.
The tidal tensor allows a classification in terms of the orbital
dinamics of the matter field.
This approach extends to second-order the equations of motion around 
local minima of the gravitational potential. 
The second-order term corresponds to the tidal tensor, which is
defined as the Hessian matrix of the normalized gravitational
potential.


%.........................................................................
%Tidal Tensor
\eq{V_web}
{	T_{\alpha\beta} = \frac{\partial^2\phi}{\partial x_{\alpha}\partial x_{\beta}},	}
%.........................................................................
where the physical gravitational potential has been rescaled by a
factor of   $4\pi G\bar{\rho}$ in such a way that $\phi$ satisfies the following 
Poisson equation

%.........................................................................
%Poisson
\eq{Poisson}
{	\nabla^2\phi = \delta,	}
%.........................................................................
with $\bar{\rho}$ the average density in the Universe, $G$ the 
gravitational constant and $\delta$ the dimensionless matter
overdensity. 

Since the tidal tensor can be represented by a real and  symmetric
$3\times 3$ matrix, it is always possible to diagonalize  
it and obtain three real eigenvalues $\lambda_{1}\geq\lambda_{2}\geq
\lambda_3$ with its corresponding eigenvectors ${\bf u}_{1}$, ${\bf u}_{2}$,
${\bf u}_{3}$. 
The eigenvalues are indicators of the local  orbital stability
in each direction ${\bf u}_i$. 
The sign of the eigenvalues can be used to classify the Cosmic Web.
The number of positive (stable) or negative (unstable) eigenvalues allows 
to label a location into one of the next four types of environment: 
voids (3 negative eigenvalues), sheets (2), filaments (1) and knots (0). 

A modification to this scheme was introduced by \citet{Forero09}
by means of a relaxation of the stability criterion. 
The relative strength  of each eigenvalue is no longer defined by the
sign, but instead by a threshold value $\lambda_{\rm th}$ that can be
tuned in such a way that the visual impression of the web-like matter
distribution is reproduced. 
 
%-------------------------------------------------------------------------
\subsection{The velocity web (V-Web)}
\label{subsec:Vweb}
%-------------------------------------------------------------------------


We also use a kinematic scheme to define the Cosmic Web environment in 
the simulation introduced by \cite{Hoffman12}.
The V-web scheme for environment finding is based on the
local velocity shear tensor calculated from the smoothed dark matter 
velocity field in the simulation. This tensor is given by the 
following expression

%.........................................................................
%V-Web Definition
\eq{V_web}
{	\Sigma_{\alpha\beta} = -\frac{1}{2H_0}\pr{\frac{\partial v_{\alpha}}
{\partial x_{\beta}}+\frac{\partial v_{\beta}}{\partial x_{\alpha}}},}
%.........................................................................
where $v_{\alpha}$ and $x_{\alpha}$ represent the $\alpha$ component of 
the comoving velocity and position, respectively. Like the tidal tensor, 
$\Sigma_{\alpha\beta}$ can be represented by a $3\times 3$ symmetric 
matrix with real values, making it possible to find three real
eigenvalues and its corresponding eigenvectors.

In this case we also use the relative strength of the three eigenvalues with 
respect to a threshold value $\lambda_{th}$ to classify the cosmic web
in the four web types already mentioned.

Usually, the threshold is a free parameter that is tuned to reproduce
the visual appearence of the comic web. 
In this paper we take a different approach.
We find the optimal value of the threshold based on the maximization
of the fractional anisotropy field in the locations label as filaments
and walls. 
This is described in detailed in the next Section.



%*************************************************************************
\section{A new void finding technique}
\label{sec:bulk_voids}
%*************************************************************************


%-------------------------------------------------------------------------
\subsection{The fractional anisotropy}
\label{subsec:FA_voids}
%-------------------------------------------------------------------------


The fractional anisotropy (FA), as developed by \citet{Basser95}, was 
conceived to quantify the anisotropy degree of a diffusion process, e.g. 
the diffusivity of water molecules through cerebral tissue in nuclear
magnetic resonance imaging. 
Here we present the FA, much in the same way as \citet{Libeskind13},
to use it as a tracer of cosmic voids.


The FA is defined as follows.
%.........................................................................
%Fractional anisotropy
\eq{fractional_anisotropy}
{{\mathrm{FA}} = \frac{1}{\sqrt{3}}\sqrt{ \frac{ (\lambda_1 - \lambda_3)^2 + 
(\lambda_2 - \lambda_3)^2 + (\lambda_1 - \lambda_2)^2}{ \lambda_1^2 + 
\lambda_2^2 + \lambda_3^2} },}
%.........................................................................
where the eigenvalues can be taken from either the T-web or the Vweb 
(FA-T-web and FA-Vweb respectively). Such as it is defined, FA$=0$ 
corresponds to an isotropic distribution ($\lambda_1=\lambda_2=\lambda_3$) 
and FA$=1$ with a highly anisotropic distribution.


In the left and middle panels of Figure \ref{fig:FA_field} we show the
FA field and web classification for both  web schemes over a slice of
an N-body simulation (described in Section \ref{sec:simulations}). 
Comparing these two panels we see that voids and knots (white
and black in the middle panel of Figure 1) display low FA values at
their  centres, becoming gradually more anisotropic at outer regions.  
On the other hand the filamentary structure (grey in the middle panel
of Figure 1) is traced by high FA values.  
These characteristics are key to use the FA as a tracer of cosmic voids. 



%-------------------------------------------------------------------------
\subsection{Fractional anisotropy as a void tracer}
\label{subsec:web_voids}
%-------------------------------------------------------------------------


%-------------------------------------------------------------------------
%FIGURE 2: Distributions of FA and density regarding the Lambda_1 eigenvalue
\begin{figure*}
\centering

  \includegraphics[trim = 2mm 2mm 5mm 10mm, clip, keepaspectratio=true,
  width=0.3\textheight]{delta_L1.pdf}  
  \includegraphics[trim = 2mm 2mm 5mm 10mm, clip, keepaspectratio=true,
  width=0.3\textheight]{FA_L1.pdf}

  
  \captionof{figure}{\small Distributions of the FA (left panel) and the 
  density field (right panel) with respect to the eigenvalue $\lambda_1$ 
  for each web scheme (T-web, red lines. Vweb, blue lines) as calculated 
  over all cells of the grid. Thick central lines correspond with the median 
  and filled regions with the $50\%$ of the distribution.}

  \label{fig:L1_correlations}

\end{figure*}
%.........................................................................


Voids are regions where $\lambda_3\leq\lambda_2\leq
\lambda_1\leq\lambda_{th}$. 
This implies that a void is completely fixed by the relative strength
of the $\lambda_1$ eigenvalue with respect to the threshold.   
As we increase/decrease the threshold value $\lambda_{th}$, voids
increase/decrease progressively through contours of
increasing/decreasing $\lambda_1$.  
Voids are thus characterized by low values of both FA and
$\lambda_1$.  

In Fig. \ref{fig:L1_correlations} we show that the these two values
are indeed closely correlated.  
The right panel shows the correlation between $\lambda_1$ and $\delta$ for
all the grid cells in the simulation while the right panel shows the
correlation between $\lambda_1$ and the FA. This shows that the
overdensity has a large scatter at fixed $\lambda_1$. 

From Figs. \ref{fig:FA_field} and \ref{fig:L1_correlations} we
conclude that the FA is a good tracer of voids as it is almost perfectly
correlated with low values of $\lambda_1$. 
We propose that voids should be composed completely by regions of
FA$<0.95$.
If we increase the values of $\lambda_1$ from its minimum until it
we reach FA$=0.95$ in \ref{fig:L1_correlations} we find that this
correspond to critical values of $\lambda_{1}^T = 0.265$ and
$\lambda_{1}^V = 0.175$ for the T-web and Vweb, respectively.
This means that setting $\lambda_{th}$ to either
$\lambda_{1}^T$/$\lambda_{1}^{V}$ automatically produces voids with
all the cells FA$<0.95$.   
The middle panels in Figure \ref{fig:FA_field} show the web
classification for this choice of $\lambda_{th}$, demonstrating that
this FA level is a sensitive choice to define voids.

   
%-------------------------------------------------------------------------
\subsection{Defining voids with a watershed algorithm}
\label{sec:watershed}
%-------------------------------------------------------------------------


The previous section shows that FA is a good void tracer, but it does
not automatically suggest how to define the boundary of individual
voids.
For this purpose, we use the \textit{watershed transform algorithm}
\citep{Beucher79,Beucher93} to identify a void as the basin of FA
local minimum. 
The advantage of this definition is that it does not require any
assumption on the shape and/or morphology of the tentative voids. 

However, there are two main differences in our approach with respect to other
watershed implementations.
First, the watershed technique commonly uses the the density field
instead of the FA field as we do in this paper
\citep{Platen07,Neyrinck08}.   
Second, we estimate all relevant quantities on a Cartesian mesh of
fixed cell size, while other works use an adaptive Delaunay tessellation
\citep{Schaap00}.
However, from the analysis of our results it does not 
introduce supurious results, at least with the mass resolution we have
in the N-body simulation. 

The watershed algorithm also needs a threshold value to reduce
spurious features and prevent void hierarchization.  
If the density field is used, a typical threshold is
$\delta = -0.8$ \citep{Platen07},  which means that any ridge between
two voids with overdensity below that value is removed to merge the
respective voids. 
In our case we have to find a corresponding FA value
to define this threshold. 

In Figure \ref{fig:L1_correlations} we find the correlations of
the eigenvalue $\lambda_1$ with he matter overdensity (left panel) and
the FA (right panel).
We can use this information to find the FA threshold. 
From the left panel we see that an underdensity of $\delta=-0.8$ is
correspond to values of $\lambda_1=0.0$, regardless of the web-finding
scheme.
From the second panel we have a very tight correlation of $\lambda_1$
with the FA, indicating that in turn $\lambda_1=0.0$ corresponds to a
FA=$0.65$ which is the value that we have used to remove ridges. 

The right column in Figure \ref{fig:FA_field} shows all the individual
voids that have been identified using the watershed algorithm on the
FA field. 
In what follows we describe the numerical simulation we have used to
find voids and their detailed properties characterization.


\section{Numerical Simulation}
\label{sec:simulations}

We use the Bolshoi simulation to test our void finding method. 
This simulation follows the non-linear evolution of a dark
matter density field on a cubic volume of  size $250$\hMpc\ sampled
with $2048^3$ particles. 
The cosmological parameters in the simulation are $\Omega_{\rm
  m}=0.27$,  $\Omega_{\Lambda}  =0.73$, $h=0.70$, $n=0.95$ and
$\sigma_{8}=0.82$ for the matter density,   cosmological 
constant, dimensionless Hubble parameter, spectral index of
primordial density perturbations and normalization for the power
spectrum, respectively. 
These values are consistent with the ninth year of data of the
Wilkinson  Microwave Anisotropy Probe (WMAP) \citep{Hinshaw2013}. 
For more detailed  technical information about the simulation, see
\citet{Klypin11}. 


We use data for the cosmic web identification that is publicly
available through the MultiDark database
\url{http://www.multidark.org/MultiDark/} which is described in
\citet{Riebe11}. 
Here we briefly describe the process to obtain the data. 
For details see \cite{Forero09} (T-Web) and
\cite{Hoffman12,Forero2014} (V-Web). 
This data is based on a  \textit{cloud-in-cell} (\texttt{CIC})
interpolation of the density and velocity fields of the simulation
onto a grid of $256^3$  cells, corresponding to a spatial resolution
of $0.98$\hMpc\ per cell side.    
These fields are smoothed with a gaussian filter with a width of 
$\sigma=0.98$\hMpc. 
The tidal and shear tensors and corresponding eigenvalues are computed
through finite-differences over the potential and velocity fields.

%*************************************************************************
\section{Results}
\label{sec:results}
%*************************************************************************

We limit our results to voids with effective radius larger than the
smoothing length of the density field, i.e. $\sim 1$\hMpc.  
Below that scale numerical resolution effects become important. 
With that choice we find a volume filling fraction $54.88\%$ and
$47.06\%$ for the FA-Vweb. 

In the following subsections we describe the results for the size
distribution and different radial profiles for all our samples.

%-------------------------------------------------------------------------
\subsection{The void size distribution}
\label{subsec:shape_voids}
%-------------------------------------------------------------------------


%.........................................................................
%FIGURE 3: volume functions
\begin{figure}
\centering

  \includegraphics[trim = 0mm 0mm 0mm 0mm, clip, keepaspectratio=true,
  width=0.3\textheight]{voids_regions_volume_all.pdf}

  \captionof{figure}{\small Volume size distribution of voids for both
  catalogues. FA-T-web (red curves), FA-Vweb (blue curves).
  Continuous lines corresponds with the total number of voids, dot-dashed
  with sub-compensated voids and dashed lines with over-compensated voids. }

  \label{fig:volume_function}

\end{figure}
%.........................................................................


Void shapes exhibit a wide range of geometries.
To define their size we use its equivalent spherical radius or
effective radius, defined as $\reff = [3/(4\pi)V]^{1/3}$, with $V$ the 
total volume of the void. 
In Figure \ref{fig:volume_function} we show the void size
distributions for the T-Web and the V-Web.

We see that the void distribution for the T-Web is broadly consistent with the
expectations from a two-barrier problem  \citep{Sheth04}. 
The formation of large voids is limited by the \textit{void-in-void}
problem (first barrier), where large voids are constituted
hierarchically of smaller ones. 
In turn, the formation of small  voids is damped by the
\textit{void-in-cloud} problem (second barrier),  where nearby
collapsing structures limit the abundance of embedded small  voids.  


We also find that the V-Web scheme produces an over-abundance of small
voids compared to the resuls of the T-Web.
A large number of these small voids are embedded in dense regions. 
They are visible in the middle panel of Figure \ref{fig:FA_field} as
the small bubbles located inside sheets.
The existence of these small voids could be qualitatively explained by
dynamics of shell crossing in collapsing sheets. 
When matter colides into a sheet, at their center it is possible to
find crossing matter planes that effectively give a possitively
divergen velocity field, which gives a void identification by the
T-Web algorithm. This points has been discussed in \citet{Hoffman12}.

Comparing the abundance of large voids in the two web schemes, we find
that the V-Web is limited to have voids on the scale of $\sim 10$\hMpc,
while the T-Web scheme includes voids as large as $\sim 15$\hMpc. 
Large voids in the T-Web scheme have a velocity structure that
induces a split by the watersched algorithm in the V-Web. 
This is eviden in the right panel of Figure \ref{fig:FA_field}.

%-------------------------------------------------------------------------
\subsection{Compenseated and overcompensated voids}
\label{subsec:enclosedmass}
%-------------------------------------------------------------------------

We find that voids are distributed in two different  families differentiated by the
presence/absence of an overdense matter ridge in their density
profiles. 
To discriminate each void in one of the families we use the
compensation  index $\mathcal{C}$.
It is defined as the mass of a void enclosed in a spherical volume of
radius $R$ and normalized by the mass of the same volume assuming
it is filled by matter with the mean background density.

\eq{compensation}
{\mathcal{C} = \frac{M_v}{\overline{M}} = \frac{3}{2R^{3}} \int_0^{R} [\delta(r) + 1] r^2 dr}

We choose an integration radius of $R=4\reff$, that is large enough to 
enclose the compensation ridge for a typical void in case there is one. 
This leads us to voids with $\mathcal{C}>1$ having more mass than expected, 
constituting the family of overcompensated voids. These voids generally 
exhibit a compensation ridge associated to dense nearby structures. In the 
same fashion, voids with $\mathcal{C}<1$ constitute the family of 
subcompensated voids.


%-------------------------------------------------------------------------
\subsection{Physical profiles of voids}
\label{subsec:properties_voids}
%-------------------------------------------------------------------------


%.........................................................................
%FIGURE 4: Density profile of voids for each defined scheme
\begin{figure*}
\centering
  \includegraphics[trim = 1mm 0mm 5mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{voids_density_TwebFAG0.pdf}
  \includegraphics[trim = 1mm 0mm 5mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{voids_velocity_TwebFAG0.pdf}
  \includegraphics[trim = 1mm 0mm 5mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{voids_FA_TwebFAG0.pdf}
  
  \includegraphics[trim = 1mm 0mm 5mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{voids_density_VwebFAG0.pdf}
  \includegraphics[trim = 1mm 0mm 5mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{voids_velocity_VwebFAG0.pdf}
  \includegraphics[trim = 1mm 0mm 5mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{voids_FA_VwebFAG0.pdf}
  
  \includegraphics[trim = 1mm 0mm 5mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{voids_density_TwebFAG1.pdf}
  \includegraphics[trim = 1mm 0mm 5mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{voids_velocity_TwebFAG1.pdf}
  \includegraphics[trim = 1mm 0mm 5mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{voids_FA_TwebFAG1.pdf}

  
  \includegraphics[trim = 1mm 0mm 5mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{voids_density_VwebFAG1.pdf}
  \includegraphics[trim = 1mm 0mm 5mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{voids_velocity_VwebFAG1.pdf}
  \includegraphics[trim = 1mm 0mm 5mm 0mm, clip, keepaspectratio=true,
  width=0.24\textheight]{voids_FA_VwebFAG1.pdf}  
  

  \captionof{figure}{\small Physical internal properties of voids for 
  the two finding scheme. Density field (left panels), radial-projected
  velocity field (middle panels) and FA field (right panels). The analysis
  is performed for both, subcompensated (first two rows) and overcompensated
  voids (last two rows).}

  \label{fig:RhoVel}
  \vspace{0.1 cm}

\end{figure*}
%.........................................................................


In Fig. \ref{fig:RhoVel} we analyse the internal properties of the found 
voids. We calculate the contrast density, radial-projected velocity and 
FA profiles. For this purpose we catalogue all the voids in several radial 
bins in order to capture possible size effects; moreover we show profiles 
for both, subcompensated and overcompensated voids. Then, for each void, 
we take the distance of each member cell to the void centre along with the 
properties of interest. Normalizing these distances with the effective 
radius, we stack all the voids of a radial bin in order to compute the 
radial profiles.


%.........................................................................
\subsubsection{Density profiles}
\label{subsubsec:density_voids}
%.........................................................................


In left panels of Fig. \ref{fig:RhoVel} we compute density profiles of 
voids stacked according to their size and their compensation index. 
Instead of calculating the radial internal structure inside the effective
radius, we opted for a radius well beyond that value ($8\ \reff$) in order 
to capture the properties of neighbour structures as well. 


A first interesting result is the value at the void centres: the larger the 
void, the more underdense their value at the centre, ranging from $\delta
\approx-0.95$ for the largest voids ($8.3-12\ \hMpc$) to $\delta\approx 
-0.8$ for the smallest voids ($2-3.2\ \hMpc$). This holds for all the voids 
in both schemes. These very low values are consistent with most of the void 
finding schemes based on smooth and continuous fields from simulation or 
reconstruction procedures on surveys \citep{Plionis02, Colberg05, Shandarin06, 
Platen07, Neyrinck08, MunozCuartas11, Neyrinck13, Ricciardelli2013}, unlike
geometrical approaches based on point distributions, where central values
are generally higher \citep{Colberg08}.


Another important result is the steepness of the profiles at inner
regions. For subcompensated voids, larger voids are more steep, reaching
the mean density value at lower radius. Smaller voids exhibit moderate
slopes, reaching the mean density at much larger radius. This indicates 
smaller subcompensated voids are embedded into low density structures like 
larger voids and still forming regions like walls. For subcompensated large
voids, outer radial layers are so vast that all sort of structures are 
stacked, thus reaching the mean density at lower radius. This result 
remains also for overcompensated voids, where larger voids reach first 
both, the compensation ridge and then the mean density value.


Regarding overcompensated voids, a final result is related to the height 
of the compensation ridge: the larger the void size, the lower the ridge
height. This implies that overcompensated smaller voids are embedded in 
very high density regions, unlike their subcompensated counterpart, thus 
indicating two possibly different processes for small voids formation. 
Larger voids exhibit lower ridges as outer radial layers also includes all
sort of structures, thus being the difference between large overcompensated
and subcompensated voids less conclusive.


All the previous results hold for both finding schemes, thereby pointing 
out to an universal radial profile of voids (subcompensated and 
overcompensated), and not only for the internal structure \citep{Colberg05, 
Ricciardelli2013}, but also for outer regions \citep{Lavaux12, Hamaus14}.


%.........................................................................
\subsubsection{Velocity profiles}
\label{subsubsec:velocity_voids}
%.........................................................................


Additionally, in middle panels of Fig. \ref{fig:RhoVel} we calculate 
radial projected velocity profiles, where positive values implies outflow 
of matter, while negative ones indicates infall flows, all from the void 
centre. 


A general feature of subcompensated voids is outward velocity profiles, 
indicating that matter all along these voids and their outsides is being 
pulled out. On the other hand, overcompensated voids exhibit initially
outward profiles, as expected from a low density region. However, 
approximately at the radius of the compensation ridge, the velocity becomes 
negative, thus indicating an infall flow of matter further than the 
compensation ridge. This shows that the high density structures associated 
to a compensation ridge indeed dominate the matter flow from inside the void 
as well as falling flows from outsides.


All the profiles behave linearly near to the void centres, where larger 
voids display more steep slopes. This indicates larger voids are being
pulled out more strongly by nearby structures. On the other hand, at 
large radius, all the profiles decrease to the zero background velocity,
where larger voids reach this value first as their outer radial layers 
average a large portion of volume.


Like the density, these results also point out to an universal radial 
velocity profiles of voids \citep{Hamaus14}.

%.........................................................................
\subsubsection{FA profiles}
\label{subsubsec:FA_voids}
%.........................................................................


Finally, we also calculate FA profiles in right panels of Fig. \ref{fig:RhoVel}.
A very interesting result from this is a very clear distinction between
the internal profile, below the effective radius, and the external profile. 
For subcompensated voids, they reach quickly the background 
value after $1\reff$. On the other hand, overcompensated voids reach a FA 
ridge at the same radius and then the background value. Central values are
in agreement with those of the density and velocity fields, where larger 
voids exhibit more isotropic cores, associated to higher outflows rates 
and low mass concentrations.


The difference between the radius where the density ridge is reached 
($r\sim 2-4\hMpc$ depending on the void size), and the radius of the FA 
ridge ($r\sim 1-1.5\hMpc$ for all voids) reinforces our previous 
conclusions: before reaching high-density structures like filaments and 
cluster, high-anisotropic, middle-density walls are reached, so the FA 
ridge should be chosen as the natural frontier of voids instead of the
density ridge. This choosing would produce smaller voids as compared with
other voids finding methods, however contamination from external structures
is also avoided.


%*************************************************************************
\section{Conclusions}
\label{sec:conclusions}
%*************************************************************************


%*************************************************************************
\section*{Acknowledgments}  
%*************************************************************************

\bibliographystyle{mn2e}
\bibliography{references}

\end{document}
